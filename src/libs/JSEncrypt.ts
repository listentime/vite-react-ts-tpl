 /* eslint-disable */
 // @ts-ignore
 (function(t,e){typeof exports==="object"&&typeof module!=="undefined"?e(exports):typeof define==="function"&&define.amd?define(["exports"],e):e(t.JSEncrypt={})})(this,function(t){"use strict";var a={appName:"Netscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1"};var i={ASN1:null,Base64:null,Hex:null,crypto:null,href:null};var e="0123456789abcdefghijklmnopqrstuvwxyz";function h(t){return e.charAt(t)}function r(t,e){return t&e}function u(t,e){return t|e}function n(t,e){return t^e}function s(t,e){return t&~e}function o(t){if(t==0){return-1}var e=0;if((t&65535)==0){t>>=16;e+=16}if((t&255)==0){t>>=8;e+=8}if((t&15)==0){t>>=4;e+=4}if((t&3)==0){t>>=2;e+=2}if((t&1)==0){++e}return e}function f(t){var e=0;while(t!=0){t&=t-1;++e}return e}var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var c="=";function g(t){var e;var i;var r="";for(e=0;e+3<=t.length;e+=3){i=parseInt(t.substring(e,e+3),16);r+=l.charAt(i>>6)+l.charAt(i&63)}if(e+1==t.length){i=parseInt(t.substring(e,e+1),16);r+=l.charAt(i<<2)}else if(e+2==t.length){i=parseInt(t.substring(e,e+2),16);r+=l.charAt(i>>2)+l.charAt((i&3)<<4)}while((r.length&3)>0){r+=c}return r}function p(t){var e="";var i;var r=0;var n=0;for(i=0;i<t.length;++i){if(t.charAt(i)==c){break}var s=l.indexOf(t.charAt(i));if(s<0){continue}if(r==0){e+=h(s>>2);n=s&3;r=1}else if(r==1){e+=h(n<<2|s>>4);n=s&15;r=2}else if(r==2){e+=h(n);e+=h(s>>2);n=s&3;r=3}else{e+=h(n<<2|s>>4);e+=h(s&15);r=0}}if(r==1){e+=h(n<<2)}return e}var v=function(t,e){v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return v(t,e)};function d(t,e){v(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}var y;var m={decode:function(t){var e;if(y===undefined){var i="0123456789ABCDEF";var r=" \f\n\r\t \u2028\u2029";y={};for(e=0;e<16;++e){y[i.charAt(e)]=e}i=i.toLowerCase();for(e=10;e<16;++e){y[i.charAt(e)]=e}for(e=0;e<r.length;++e){y[r.charAt(e)]=-1}}var n=[];var s=0;var o=0;for(e=0;e<t.length;++e){var a=t.charAt(e);if(a=="="){break}a=y[a];if(a==-1){continue}if(a===undefined){throw new Error("Illegal character at offset "+e)}s|=a;if(++o>=2){n[n.length]=s;s=0;o=0}else{s<<=4}}if(o){throw new Error("Hex encoding incomplete: 4 bits missing")}return n}};var b;var T={decode:function(t){var e;if(b===undefined){var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var r="= \f\n\r\t \u2028\u2029";b=Object.create(null);for(e=0;e<64;++e){b[i.charAt(e)]=e}for(e=0;e<r.length;++e){b[r.charAt(e)]=-1}}var n=[];var s=0;var o=0;for(e=0;e<t.length;++e){var a=t.charAt(e);if(a=="="){break}a=b[a];if(a==-1){continue}if(a===undefined){throw new Error("Illegal character at offset "+e)}s|=a;if(++o>=4){n[n.length]=s>>16;n[n.length]=s>>8&255;n[n.length]=s&255;s=0;o=0}else{s<<=6}}switch(o){case 1:throw new Error("Base64 encoding incomplete: at least 2 bits missing");case 2:n[n.length]=s>>10;break;case 3:n[n.length]=s>>16;n[n.length]=s>>8&255;break}return n},re:/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,unarmor:function(t){var e=T.re.exec(t);if(e){if(e[1]){t=e[1]}else if(e[2]){t=e[2]}else{throw new Error("RegExp out of sync")}}return T.decode(t)}};var S=1e13;var w=function(){function t(t){this.buf=[+t||0]}t.prototype.mulAdd=function(t,e){var i=this.buf;var r=i.length;var n;var s;for(n=0;n<r;++n){s=i[n]*t+e;if(s<S){e=0}else{e=0|s/S;s-=e*S}i[n]=s}if(e>0){i[n]=e}};t.prototype.sub=function(t){var e=this.buf;var i=e.length;var r;var n;for(r=0;r<i;++r){n=e[r]-t;if(n<0){n+=S;t=1}else{t=0}e[r]=n}while(e[e.length-1]===0){e.pop()}};t.prototype.toString=function(t){if((t||10)!=10){throw new Error("only base 10 is supported")}var e=this.buf;var i=e[e.length-1].toString();for(var r=e.length-2;r>=0;--r){i+=(S+e[r]).toString().substring(1)}return i};t.prototype.valueOf=function(){var t=this.buf;var e=0;for(var i=t.length-1;i>=0;--i){e=e*S+t[i]}return e};t.prototype.simplify=function(){var t=this.buf;return t.length==1?t[0]:this};return t}();var E="…";var D=/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/;var x=/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/;function B(t,e){if(t.length>e){t=t.substring(0,e)+E}return t}var R=function(){function i(t,e){this.hexDigits="0123456789ABCDEF";if(t instanceof i){this.enc=t.enc;this.pos=t.pos}else{this.enc=t;this.pos=e}}i.prototype.get=function(t){if(t===undefined){t=this.pos++}if(t>=this.enc.length){throw new Error("Requesting byte offset "+t+" on a stream of length "+this.enc.length)}return"string"===typeof this.enc?this.enc.charCodeAt(t):this.enc[t]};i.prototype.hexByte=function(t){return this.hexDigits.charAt(t>>4&15)+this.hexDigits.charAt(t&15)};i.prototype.hexDump=function(t,e,i){var r="";for(var n=t;n<e;++n){r+=this.hexByte(this.get(n));if(i!==true){switch(n&15){case 7:r+="  ";break;case 15:r+="\n";break;default:r+=" "}}}return r};i.prototype.isASCII=function(t,e){for(var i=t;i<e;++i){var r=this.get(i);if(r<32||r>176){return false}}return true};i.prototype.parseStringISO=function(t,e){var i="";for(var r=t;r<e;++r){i+=String.fromCharCode(this.get(r))}return i};i.prototype.parseStringUTF=function(t,e){var i="";for(var r=t;r<e;){var n=this.get(r++);if(n<128){i+=String.fromCharCode(n)}else if(n>191&&n<224){i+=String.fromCharCode((n&31)<<6|this.get(r++)&63)}else{i+=String.fromCharCode((n&15)<<12|(this.get(r++)&63)<<6|this.get(r++)&63)}}return i};i.prototype.parseStringBMP=function(t,e){var i="";var r;var n;for(var s=t;s<e;){r=this.get(s++);n=this.get(s++);i+=String.fromCharCode(r<<8|n)}return i};i.prototype.parseTime=function(t,e,i){var r=this.parseStringISO(t,e);var n=(i?D:x).exec(r);if(!n){return"Unrecognized time: "+r}if(i){n[1]=+n[1];n[1]+=+n[1]<70?2e3:1900}r=n[1]+"-"+n[2]+"-"+n[3]+" "+n[4];if(n[5]){r+=":"+n[5];if(n[6]){r+=":"+n[6];if(n[7]){r+="."+n[7]}}}if(n[8]){r+=" UTC";if(n[8]!="Z"){r+=n[8];if(n[9]){r+=":"+n[9]}}}return r};i.prototype.parseInteger=function(t,e){var i=this.get(t);var r=i>127;var n=r?255:0;var s;var o="";while(i==n&&++t<e){i=this.get(t)}s=e-t;if(s===0){return r?-1:0}if(s>4){o=i;s<<=3;while(((+o^n)&128)==0){o=+o<<1;--s}o="("+s+" bit)\n"}if(r){i=i-256}var a=new w(i);for(var h=t+1;h<e;++h){a.mulAdd(256,this.get(h))}return o+a.toString()};i.prototype.parseBitString=function(t,e,i){var r=this.get(t);var n=(e-t-1<<3)-r;var s="("+n+" bit)\n";var o="";for(var a=t+1;a<e;++a){var h=this.get(a);var u=a==e-1?r:0;for(var f=7;f>=u;--f){o+=h>>f&1?"1":"0"}if(o.length>i){return s+B(o,i)}}return s+o};i.prototype.parseOctetString=function(t,e,i){if(this.isASCII(t,e)){return B(this.parseStringISO(t,e),i)}var r=e-t;var n="("+r+" byte)\n";i/=2;if(r>i){e=t+i}for(var s=t;s<e;++s){n+=this.hexByte(this.get(s))}if(r>i){n+=E}return n};i.prototype.parseOID=function(t,e,i){var r="";var n=new w;var s=0;for(var o=t;o<e;++o){var a=this.get(o);n.mulAdd(128,a&127);s+=7;if(!(a&128)){if(r===""){n=n.simplify();if(n instanceof w){n.sub(80);r="2."+n.toString()}else{var h=n<80?n<40?0:1:2;r=h+"."+(n-h*40)}}else{r+="."+n.toString()}if(r.length>i){return B(r,i)}n=new w;s=0}}if(s>0){r+=".incomplete"}return r};return i}();var A=function(){function f(t,e,i,r,n){if(!(r instanceof O)){throw new Error("Invalid tag value.")}this.stream=t;this.header=e;this.length=i;this.tag=r;this.sub=n}f.prototype.typeName=function(){switch(this.tag.tagClass){case 0:switch(this.tag.tagNumber){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString"}return"Universal_"+this.tag.tagNumber.toString();case 1:return"Application_"+this.tag.tagNumber.toString();case 2:return"["+this.tag.tagNumber.toString()+"]";case 3:return"Private_"+this.tag.tagNumber.toString()}};f.prototype.content=function(t){if(this.tag===undefined){return null}if(t===undefined){t=Infinity}var e=this.posContent();var i=Math.abs(this.length);if(!this.tag.isUniversal()){if(this.sub!==null){return"("+this.sub.length+" elem)"}return this.stream.parseOctetString(e,e+i,t)}switch(this.tag.tagNumber){case 1:return this.stream.get(e)===0?"false":"true";case 2:return this.stream.parseInteger(e,e+i);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(e,e+i,t);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(e,e+i,t);case 6:return this.stream.parseOID(e,e+i,t);case 16:case 17:if(this.sub!==null){return"("+this.sub.length+" elem)"}else{return"(no elem)"}case 12:return B(this.stream.parseStringUTF(e,e+i),t);case 18:case 19:case 20:case 21:case 22:case 26:return B(this.stream.parseStringISO(e,e+i),t);case 30:return B(this.stream.parseStringBMP(e,e+i),t);case 23:case 24:return this.stream.parseTime(e,e+i,this.tag.tagNumber==23)}return null};f.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(this.sub===null?"null":this.sub.length)+"]"};f.prototype.toPrettyString=function(t){if(t===undefined){t=""}var e=t+this.typeName()+" @"+this.stream.pos;if(this.length>=0){e+="+"}e+=this.length;if(this.tag.tagConstructed){e+=" (constructed)"}else if(this.tag.isUniversal()&&(this.tag.tagNumber==3||this.tag.tagNumber==4)&&this.sub!==null){e+=" (encapsulates)"}e+="\n";if(this.sub!==null){t+="  ";for(var i=0,r=this.sub.length;i<r;++i){e+=this.sub[i].toPrettyString(t)}}return e};f.prototype.posStart=function(){return this.stream.pos};f.prototype.posContent=function(){return this.stream.pos+this.header};f.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)};f.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),true)};f.decodeLength=function(t){var e=t.get();var i=e&127;if(i==e){return i}if(i>6){throw new Error("Length over 48 bits not supported at position "+(t.pos-1))}if(i===0){return null}e=0;for(var r=0;r<i;++r){e=e*256+t.get()}return e};f.prototype.getHexStringValue=function(){var t=this.toHexString();var e=this.header*2;var i=this.length*2;return t.substr(e,i)};f.decode=function(t){var r;if(!(t instanceof R)){r=new R(t,0)}else{r=t}var e=new R(r);var i=new O(r);var n=f.decodeLength(r);var s=r.pos;var o=s-e.pos;var a=null;var h=function(){var t=[];if(n!==null){var e=s+n;while(r.pos<e){t[t.length]=f.decode(r)}if(r.pos!=e){throw new Error("Content size is not correct for container starting at offset "+s)}}else{try{for(;;){var i=f.decode(r);if(i.tag.isEOC()){break}t[t.length]=i}n=s-r.pos}catch(t){throw new Error("Exception while decoding undefined length content: "+t)}}return t};if(i.tagConstructed){a=h()}else if(i.isUniversal()&&(i.tagNumber==3||i.tagNumber==4)){try{if(i.tagNumber==3){if(r.get()!=0){throw new Error("BIT STRINGs with unused bits cannot encapsulate.")}}a=h();for(var u=0;u<a.length;++u){if(a[u].tag.isEOC()){throw new Error("EOC is not supposed to be actual content.")}}}catch(t){a=null}}if(a===null){if(n===null){throw new Error("We can't skip over an invalid tag with undefined length at offset "+s)}r.pos=s+Math.abs(n)}return new f(e,o,n,i,a)};return f}();var O=function(){function t(t){var e=t.get();this.tagClass=e>>6;this.tagConstructed=(e&32)!==0;this.tagNumber=e&31;if(this.tagNumber==31){var i=new w;do{e=t.get();i.mulAdd(128,e&127)}while(e&128);this.tagNumber=i.simplify()}}t.prototype.isUniversal=function(){return this.tagClass===0};t.prototype.isEOC=function(){return this.tagClass===0&&this.tagNumber===0};return t}();var V;var I=0xdeadbeefcafe;var N=(I&16777215)==15715070;var P=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997];var M=(1<<26)/P[P.length-1];var q=function(){function b(t,e,i){if(t!=null){if("number"==typeof t){this.fromNumber(t,e,i)}else if(e==null&&"string"!=typeof t){this.fromString(t,256)}else{this.fromString(t,e)}}}b.prototype.toString=function(t){if(this.s<0){return"-"+this.negate().toString(t)}var e;if(t==16){e=4}else if(t==8){e=3}else if(t==2){e=1}else if(t==32){e=5}else if(t==4){e=2}else{return this.toRadix(t)}var i=(1<<e)-1;var r;var n=false;var s="";var o=this.t;var a=this.DB-o*this.DB%e;if(o-- >0){if(a<this.DB&&(r=this[o]>>a)>0){n=true;s=h(r)}while(o>=0){if(a<e){r=(this[o]&(1<<a)-1)<<e-a;r|=this[--o]>>(a+=this.DB-e)}else{r=this[o]>>(a-=e)&i;if(a<=0){a+=this.DB;--o}}if(r>0){n=true}if(n){s+=h(r)}}}return n?s:"0"};b.prototype.negate=function(){var t=K();b.ZERO.subTo(this,t);return t};b.prototype.abs=function(){return this.s<0?this.negate():this};b.prototype.compareTo=function(t){var e=this.s-t.s;if(e!=0){return e}var i=this.t;e=i-t.t;if(e!=0){return this.s<0?-e:e}while(--i>=0){if((e=this[i]-t[i])!=0){return e}}return 0};b.prototype.bitLength=function(){if(this.t<=0){return 0}return this.DB*(this.t-1)+X(this[this.t-1]^this.s&this.DM)};b.prototype.mod=function(t){var e=K();this.abs().divRemTo(t,null,e);if(this.s<0&&e.compareTo(b.ZERO)>0){t.subTo(e,e)}return e};b.prototype.modPowInt=function(t,e){var i;if(t<256||e.isEven()){i=new j(e)}else{i=new H(e)}return this.exp(t,i)};b.prototype.clone=function(){var t=K();this.copyTo(t);return t};b.prototype.intValue=function(){if(this.s<0){if(this.t==1){return this[0]-this.DV}else if(this.t==0){return-1}}else if(this.t==1){return this[0]}else if(this.t==0){return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]};b.prototype.byteValue=function(){return this.t==0?this.s:this[0]<<24>>24};b.prototype.shortValue=function(){return this.t==0?this.s:this[0]<<16>>16};b.prototype.signum=function(){if(this.s<0){return-1}else if(this.t<=0||this.t==1&&this[0]<=0){return 0}else{return 1}};b.prototype.toByteArray=function(){var t=this.t;var e=[];e[0]=this.s;var i=this.DB-t*this.DB%8;var r;var n=0;if(t-- >0){if(i<this.DB&&(r=this[t]>>i)!=(this.s&this.DM)>>i){e[n++]=r|this.s<<this.DB-i}while(t>=0){if(i<8){r=(this[t]&(1<<i)-1)<<8-i;r|=this[--t]>>(i+=this.DB-8)}else{r=this[t]>>(i-=8)&255;if(i<=0){i+=this.DB;--t}}if((r&128)!=0){r|=-256}if(n==0&&(this.s&128)!=(r&128)){++n}if(n>0||r!=this.s){e[n++]=r}}}return e};b.prototype.equals=function(t){return this.compareTo(t)==0};b.prototype.min=function(t){return this.compareTo(t)<0?this:t};b.prototype.max=function(t){return this.compareTo(t)>0?this:t};b.prototype.and=function(t){var e=K();this.bitwiseTo(t,r,e);return e};b.prototype.or=function(t){var e=K();this.bitwiseTo(t,u,e);return e};b.prototype.xor=function(t){var e=K();this.bitwiseTo(t,n,e);return e};b.prototype.andNot=function(t){var e=K();this.bitwiseTo(t,s,e);return e};b.prototype.not=function(){var t=K();for(var e=0;e<this.t;++e){t[e]=this.DM&~this[e]}t.t=this.t;t.s=~this.s;return t};b.prototype.shiftLeft=function(t){var e=K();if(t<0){this.rShiftTo(-t,e)}else{this.lShiftTo(t,e)}return e};b.prototype.shiftRight=function(t){var e=K();if(t<0){this.lShiftTo(-t,e)}else{this.rShiftTo(t,e)}return e};b.prototype.getLowestSetBit=function(){for(var t=0;t<this.t;++t){if(this[t]!=0){return t*this.DB+o(this[t])}}if(this.s<0){return this.t*this.DB}return-1};b.prototype.bitCount=function(){var t=0;var e=this.s&this.DM;for(var i=0;i<this.t;++i){t+=f(this[i]^e)}return t};b.prototype.testBit=function(t){var e=Math.floor(t/this.DB);if(e>=this.t){return this.s!=0}return(this[e]&1<<t%this.DB)!=0};b.prototype.setBit=function(t){return this.changeBit(t,u)};b.prototype.clearBit=function(t){return this.changeBit(t,s)};b.prototype.flipBit=function(t){return this.changeBit(t,n)};b.prototype.add=function(t){var e=K();this.addTo(t,e);return e};b.prototype.subtract=function(t){var e=K();this.subTo(t,e);return e};b.prototype.multiply=function(t){var e=K();this.multiplyTo(t,e);return e};b.prototype.divide=function(t){var e=K();this.divRemTo(t,e,null);return e};b.prototype.remainder=function(t){var e=K();this.divRemTo(t,null,e);return e};b.prototype.divideAndRemainder=function(t){var e=K();var i=K();this.divRemTo(t,e,i);return[e,i]};b.prototype.modPow=function(t,e){var i=t.bitLength();var r;var n=J(1);var s;if(i<=0){return n}else if(i<18){r=1}else if(i<48){r=3}else if(i<144){r=4}else if(i<768){r=5}else{r=6}if(i<8){s=new j(e)}else if(e.isEven()){s=new C(e)}else{s=new H(e)}var o=[];var a=3;var h=r-1;var u=(1<<r)-1;o[1]=s.convert(this);if(r>1){var f=K();s.sqrTo(o[1],f);while(a<=u){o[a]=K();s.mulTo(f,o[a-2],o[a]);a+=2}}var l=t.t-1;var c;var p=true;var v=K();var g;i=X(t[l])-1;while(l>=0){if(i>=h){c=t[l]>>i-h&u}else{c=(t[l]&(1<<i+1)-1)<<h-i;if(l>0){c|=t[l-1]>>this.DB+i-h}}a=r;while((c&1)==0){c>>=1;--a}if((i-=a)<0){i+=this.DB;--l}if(p){o[c].copyTo(n);p=false}else{while(a>1){s.sqrTo(n,v);s.sqrTo(v,n);a-=2}if(a>0){s.sqrTo(n,v)}else{g=n;n=v;v=g}s.mulTo(v,o[c],n)}while(l>=0&&(t[l]&1<<i)==0){s.sqrTo(n,v);g=n;n=v;v=g;if(--i<0){i=this.DB-1;--l}}}return s.revert(n)};b.prototype.modInverse=function(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0){return b.ZERO}var i=t.clone();var r=this.clone();var n=J(1);var s=J(0);var o=J(0);var a=J(1);while(i.signum()!=0){while(i.isEven()){i.rShiftTo(1,i);if(e){if(!n.isEven()||!s.isEven()){n.addTo(this,n);s.subTo(t,s)}n.rShiftTo(1,n)}else if(!s.isEven()){s.subTo(t,s)}s.rShiftTo(1,s)}while(r.isEven()){r.rShiftTo(1,r);if(e){if(!o.isEven()||!a.isEven()){o.addTo(this,o);a.subTo(t,a)}o.rShiftTo(1,o)}else if(!a.isEven()){a.subTo(t,a)}a.rShiftTo(1,a)}if(i.compareTo(r)>=0){i.subTo(r,i);if(e){n.subTo(o,n)}s.subTo(a,s)}else{r.subTo(i,r);if(e){o.subTo(n,o)}a.subTo(s,a)}}if(r.compareTo(b.ONE)!=0){return b.ZERO}if(a.compareTo(t)>=0){return a.subtract(t)}if(a.signum()<0){a.addTo(t,a)}else{return a}if(a.signum()<0){return a.add(t)}else{return a}};b.prototype.pow=function(t){return this.exp(t,new L)};b.prototype.gcd=function(t){var e=this.s<0?this.negate():this.clone();var i=t.s<0?t.negate():t.clone();if(e.compareTo(i)<0){var r=e;e=i;i=r}var n=e.getLowestSetBit();var s=i.getLowestSetBit();if(s<0){return e}if(n<s){s=n}if(s>0){e.rShiftTo(s,e);i.rShiftTo(s,i)}while(e.signum()>0){if((n=e.getLowestSetBit())>0){e.rShiftTo(n,e)}if((n=i.getLowestSetBit())>0){i.rShiftTo(n,i)}if(e.compareTo(i)>=0){e.subTo(i,e);e.rShiftTo(1,e)}else{i.subTo(e,i);i.rShiftTo(1,i)}}if(s>0){i.lShiftTo(s,i)}return i};b.prototype.isProbablePrime=function(t){var e;var i=this.abs();if(i.t==1&&i[0]<=P[P.length-1]){for(e=0;e<P.length;++e){if(i[0]==P[e]){return true}}return false}if(i.isEven()){return false}e=1;while(e<P.length){var r=P[e];var n=e+1;while(n<P.length&&r<M){r*=P[n++]}r=i.modInt(r);while(e<n){if(r%P[e++]==0){return false}}}return i.millerRabin(t)};b.prototype.copyTo=function(t){for(var e=this.t-1;e>=0;--e){t[e]=this[e]}t.t=this.t;t.s=this.s};b.prototype.fromInt=function(t){this.t=1;this.s=t<0?-1:0;if(t>0){this[0]=t}else if(t<-1){this[0]=t+this.DV}else{this.t=0}};b.prototype.fromString=function(t,e){var i;if(e==16){i=4}else if(e==8){i=3}else if(e==256){i=8}else if(e==2){i=1}else if(e==32){i=5}else if(e==4){i=2}else{this.fromRadix(t,e);return}this.t=0;this.s=0;var r=t.length;var n=false;var s=0;while(--r>=0){var o=i==8?+t[r]&255:Y(t,r);if(o<0){if(t.charAt(r)=="-"){n=true}continue}n=false;if(s==0){this[this.t++]=o}else if(s+i>this.DB){this[this.t-1]|=(o&(1<<this.DB-s)-1)<<s;this[this.t++]=o>>this.DB-s}else{this[this.t-1]|=o<<s}s+=i;if(s>=this.DB){s-=this.DB}}if(i==8&&(+t[0]&128)!=0){this.s=-1;if(s>0){this[this.t-1]|=(1<<this.DB-s)-1<<s}}this.clamp();if(n){b.ZERO.subTo(this,this)}};b.prototype.clamp=function(){var t=this.s&this.DM;while(this.t>0&&this[this.t-1]==t){--this.t}};b.prototype.dlShiftTo=function(t,e){var i;for(i=this.t-1;i>=0;--i){e[i+t]=this[i]}for(i=t-1;i>=0;--i){e[i]=0}e.t=this.t+t;e.s=this.s};b.prototype.drShiftTo=function(t,e){for(var i=t;i<this.t;++i){e[i-t]=this[i]}e.t=Math.max(this.t-t,0);e.s=this.s};b.prototype.lShiftTo=function(t,e){var i=t%this.DB;var r=this.DB-i;var n=(1<<r)-1;var s=Math.floor(t/this.DB);var o=this.s<<i&this.DM;for(var a=this.t-1;a>=0;--a){e[a+s+1]=this[a]>>r|o;o=(this[a]&n)<<i}for(var a=s-1;a>=0;--a){e[a]=0}e[s]=o;e.t=this.t+s+1;e.s=this.s;e.clamp()};b.prototype.rShiftTo=function(t,e){e.s=this.s;var i=Math.floor(t/this.DB);if(i>=this.t){e.t=0;return}var r=t%this.DB;var n=this.DB-r;var s=(1<<r)-1;e[0]=this[i]>>r;for(var o=i+1;o<this.t;++o){e[o-i-1]|=(this[o]&s)<<n;e[o-i]=this[o]>>r}if(r>0){e[this.t-i-1]|=(this.s&s)<<n}e.t=this.t-i;e.clamp()};b.prototype.subTo=function(t,e){var i=0;var r=0;var n=Math.min(t.t,this.t);while(i<n){r+=this[i]-t[i];e[i++]=r&this.DM;r>>=this.DB}if(t.t<this.t){r-=t.s;while(i<this.t){r+=this[i];e[i++]=r&this.DM;r>>=this.DB}r+=this.s}else{r+=this.s;while(i<t.t){r-=t[i];e[i++]=r&this.DM;r>>=this.DB}r-=t.s}e.s=r<0?-1:0;if(r<-1){e[i++]=this.DV+r}else if(r>0){e[i++]=r}e.t=i;e.clamp()};b.prototype.multiplyTo=function(t,e){var i=this.abs();var r=t.abs();var n=i.t;e.t=n+r.t;while(--n>=0){e[n]=0}for(n=0;n<r.t;++n){e[n+i.t]=i.am(0,r[n],e,n,0,i.t)}e.s=0;e.clamp();if(this.s!=t.s){b.ZERO.subTo(e,e)}};b.prototype.squareTo=function(t){var e=this.abs();var i=t.t=2*e.t;while(--i>=0){t[i]=0}for(i=0;i<e.t-1;++i){var r=e.am(i,e[i],t,2*i,0,1);if((t[i+e.t]+=e.am(i+1,2*e[i],t,2*i+1,r,e.t-i-1))>=e.DV){t[i+e.t]-=e.DV;t[i+e.t+1]=1}}if(t.t>0){t[t.t-1]+=e.am(i,e[i],t,2*i,0,1)}t.s=0;t.clamp()};b.prototype.divRemTo=function(t,e,i){var r=t.abs();if(r.t<=0){return}var n=this.abs();if(n.t<r.t){if(e!=null){e.fromInt(0)}if(i!=null){this.copyTo(i)}return}if(i==null){i=K()}var s=K();var o=this.s;var a=t.s;var h=this.DB-X(r[r.t-1]);if(h>0){r.lShiftTo(h,s);n.lShiftTo(h,i)}else{r.copyTo(s);n.copyTo(i)}var u=s.t;var f=s[u-1];if(f==0){return}var l=f*(1<<this.F1)+(u>1?s[u-2]>>this.F2:0);var c=this.FV/l;var p=(1<<this.F1)/l;var v=1<<this.F2;var g=i.t;var d=g-u;var y=e==null?K():e;s.dlShiftTo(d,y);if(i.compareTo(y)>=0){i[i.t++]=1;i.subTo(y,i)}b.ONE.dlShiftTo(u,y);y.subTo(s,s);while(s.t<u){s[s.t++]=0}while(--d>=0){var m=i[--g]==f?this.DM:Math.floor(i[g]*c+(i[g-1]+v)*p);if((i[g]+=s.am(0,m,i,d,0,u))<m){s.dlShiftTo(d,y);i.subTo(y,i);while(i[g]<--m){i.subTo(y,i)}}}if(e!=null){i.drShiftTo(u,e);if(o!=a){b.ZERO.subTo(e,e)}}i.t=u;i.clamp();if(h>0){i.rShiftTo(h,i)}if(o<0){b.ZERO.subTo(i,i)}};b.prototype.invDigit=function(){if(this.t<1){return 0}var t=this[0];if((t&1)==0){return 0}var e=t&3;e=e*(2-(t&15)*e)&15;e=e*(2-(t&255)*e)&255;e=e*(2-((t&65535)*e&65535))&65535;e=e*(2-t*e%this.DV)%this.DV;return e>0?this.DV-e:-e};b.prototype.isEven=function(){return(this.t>0?this[0]&1:this.s)==0};b.prototype.exp=function(t,e){if(t>4294967295||t<1){return b.ONE}var i=K();var r=K();var n=e.convert(this);var s=X(t)-1;n.copyTo(i);while(--s>=0){e.sqrTo(i,r);if((t&1<<s)>0){e.mulTo(r,n,i)}else{var o=i;i=r;r=o}}return e.revert(i)};b.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))};b.prototype.toRadix=function(t){if(t==null){t=10}if(this.signum()==0||t<2||t>36){return"0"}var e=this.chunkSize(t);var i=Math.pow(t,e);var r=J(i);var n=K();var s=K();var o="";this.divRemTo(r,n,s);while(n.signum()>0){o=(i+s.intValue()).toString(t).substr(1)+o;n.divRemTo(r,n,s)}return s.intValue().toString(t)+o};b.prototype.fromRadix=function(t,e){this.fromInt(0);if(e==null){e=10}var i=this.chunkSize(e);var r=Math.pow(e,i);var n=false;var s=0;var o=0;for(var a=0;a<t.length;++a){var h=Y(t,a);if(h<0){if(t.charAt(a)=="-"&&this.signum()==0){n=true}continue}o=e*o+h;if(++s>=i){this.dMultiply(r);this.dAddOffset(o,0);s=0;o=0}}if(s>0){this.dMultiply(Math.pow(e,s));this.dAddOffset(o,0)}if(n){b.ZERO.subTo(this,this)}};b.prototype.fromNumber=function(t,e,i){if("number"==typeof e){if(t<2){this.fromInt(1)}else{this.fromNumber(t,i);if(!this.testBit(t-1)){this.bitwiseTo(b.ONE.shiftLeft(t-1),u,this)}if(this.isEven()){this.dAddOffset(1,0)}while(!this.isProbablePrime(e)){this.dAddOffset(2,0);if(this.bitLength()>t){this.subTo(b.ONE.shiftLeft(t-1),this)}}}}else{var r=[];var n=t&7;r.length=(t>>3)+1;e.nextBytes(r);if(n>0){r[0]&=(1<<n)-1}else{r[0]=0}this.fromString(r,256)}};b.prototype.bitwiseTo=function(t,e,i){var r;var n;var s=Math.min(t.t,this.t);for(r=0;r<s;++r){i[r]=e(this[r],t[r])}if(t.t<this.t){n=t.s&this.DM;for(r=s;r<this.t;++r){i[r]=e(this[r],n)}i.t=this.t}else{n=this.s&this.DM;for(r=s;r<t.t;++r){i[r]=e(n,t[r])}i.t=t.t}i.s=e(this.s,t.s);i.clamp()};b.prototype.changeBit=function(t,e){var i=b.ONE.shiftLeft(t);this.bitwiseTo(i,e,i);return i};b.prototype.addTo=function(t,e){var i=0;var r=0;var n=Math.min(t.t,this.t);while(i<n){r+=this[i]+t[i];e[i++]=r&this.DM;r>>=this.DB}if(t.t<this.t){r+=t.s;while(i<this.t){r+=this[i];e[i++]=r&this.DM;r>>=this.DB}r+=this.s}else{r+=this.s;while(i<t.t){r+=t[i];e[i++]=r&this.DM;r>>=this.DB}r+=t.s}e.s=r<0?-1:0;if(r>0){e[i++]=r}else if(r<-1){e[i++]=this.DV+r}e.t=i;e.clamp()};b.prototype.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t);++this.t;this.clamp()};b.prototype.dAddOffset=function(t,e){if(t==0){return}while(this.t<=e){this[this.t++]=0}this[e]+=t;while(this[e]>=this.DV){this[e]-=this.DV;if(++e>=this.t){this[this.t++]=0}++this[e]}};b.prototype.multiplyLowerTo=function(t,e,i){var r=Math.min(this.t+t.t,e);i.s=0;i.t=r;while(r>0){i[--r]=0}for(var n=i.t-this.t;r<n;++r){i[r+this.t]=this.am(0,t[r],i,r,0,this.t)}for(var n=Math.min(t.t,e);r<n;++r){this.am(0,t[r],i,r,0,e-r)}i.clamp()};b.prototype.multiplyUpperTo=function(t,e,i){--e;var r=i.t=this.t+t.t-e;i.s=0;while(--r>=0){i[r]=0}for(r=Math.max(e-this.t,0);r<t.t;++r){i[this.t+r-e]=this.am(e-r,t[r],i,0,0,this.t+r-e)}i.clamp();i.drShiftTo(1,i)};b.prototype.modInt=function(t){if(t<=0){return 0}var e=this.DV%t;var i=this.s<0?t-1:0;if(this.t>0){if(e==0){i=this[0]%t}else{for(var r=this.t-1;r>=0;--r){i=(e*i+this[r])%t}}}return i};b.prototype.millerRabin=function(t){var e=this.subtract(b.ONE);var i=e.getLowestSetBit();if(i<=0){return false}var r=e.shiftRight(i);t=t+1>>1;if(t>P.length){t=P.length}var n=K();for(var s=0;s<t;++s){n.fromInt(P[Math.floor(Math.random()*P.length)]);var o=n.modPow(r,this);if(o.compareTo(b.ONE)!=0&&o.compareTo(e)!=0){var a=1;while(a++<i&&o.compareTo(e)!=0){o=o.modPowInt(2,this);if(o.compareTo(b.ONE)==0){return false}}if(o.compareTo(e)!=0){return false}}}return true};b.prototype.square=function(){var t=K();this.squareTo(t);return t};b.prototype.gcda=function(t,e){var i=this.s<0?this.negate():this.clone();var r=t.s<0?t.negate():t.clone();if(i.compareTo(r)<0){var n=i;i=r;r=n}var s=i.getLowestSetBit();var o=r.getLowestSetBit();if(o<0){e(i);return}if(s<o){o=s}if(o>0){i.rShiftTo(o,i);r.rShiftTo(o,r)}var a=function(){if((s=i.getLowestSetBit())>0){i.rShiftTo(s,i)}if((s=r.getLowestSetBit())>0){r.rShiftTo(s,r)}if(i.compareTo(r)>=0){i.subTo(r,i);i.rShiftTo(1,i)}else{r.subTo(i,r);r.rShiftTo(1,r)}if(!(i.signum()>0)){if(o>0){r.lShiftTo(o,r)}setTimeout(function(){e(r)},0)}else{setTimeout(a,0)}};setTimeout(a,10)};b.prototype.fromNumberAsync=function(t,e,i,r){if("number"==typeof e){if(t<2){this.fromInt(1)}else{this.fromNumber(t,i);if(!this.testBit(t-1)){this.bitwiseTo(b.ONE.shiftLeft(t-1),u,this)}if(this.isEven()){this.dAddOffset(1,0)}var n=this;var s=function(){n.dAddOffset(2,0);if(n.bitLength()>t){n.subTo(b.ONE.shiftLeft(t-1),n)}if(n.isProbablePrime(e)){setTimeout(function(){r()},0)}else{setTimeout(s,0)}};setTimeout(s,0)}}else{var o=[];var a=t&7;o.length=(t>>3)+1;e.nextBytes(o);if(a>0){o[0]&=(1<<a)-1}else{o[0]=0}this.fromString(o,256)}};return b}();var L=function(){function t(){}t.prototype.convert=function(t){return t};t.prototype.revert=function(t){return t};t.prototype.mulTo=function(t,e,i){t.multiplyTo(e,i)};t.prototype.sqrTo=function(t,e){t.squareTo(e)};return t}();var j=function(){function t(t){this.m=t}t.prototype.convert=function(t){if(t.s<0||t.compareTo(this.m)>=0){return t.mod(this.m)}else{return t}};t.prototype.revert=function(t){return t};t.prototype.reduce=function(t){t.divRemTo(this.m,null,t)};t.prototype.mulTo=function(t,e,i){t.multiplyTo(e,i);this.reduce(i)};t.prototype.sqrTo=function(t,e){t.squareTo(e);this.reduce(e)};return t}();var H=function(){function t(t){this.m=t;this.mp=t.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<t.DB-15)-1;this.mt2=2*t.t}t.prototype.convert=function(t){var e=K();t.abs().dlShiftTo(this.m.t,e);e.divRemTo(this.m,null,e);if(t.s<0&&e.compareTo(q.ZERO)>0){this.m.subTo(e,e)}return e};t.prototype.revert=function(t){var e=K();t.copyTo(e);this.reduce(e);return e};t.prototype.reduce=function(t){while(t.t<=this.mt2){t[t.t++]=0}for(var e=0;e<this.m.t;++e){var i=t[e]&32767;var r=i*this.mpl+((i*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;i=e+this.m.t;t[i]+=this.m.am(0,r,t,e,0,this.m.t);while(t[i]>=t.DV){t[i]-=t.DV;t[++i]++}}t.clamp();t.drShiftTo(this.m.t,t);if(t.compareTo(this.m)>=0){t.subTo(this.m,t)}};t.prototype.mulTo=function(t,e,i){t.multiplyTo(e,i);this.reduce(i)};t.prototype.sqrTo=function(t,e){t.squareTo(e);this.reduce(e)};return t}();var C=function(){function t(t){this.m=t;this.r2=K();this.q3=K();q.ONE.dlShiftTo(2*t.t,this.r2);this.mu=this.r2.divide(t)}t.prototype.convert=function(t){if(t.s<0||t.t>2*this.m.t){return t.mod(this.m)}else if(t.compareTo(this.m)<0){return t}else{var e=K();t.copyTo(e);this.reduce(e);return e}};t.prototype.revert=function(t){return t};t.prototype.reduce=function(t){t.drShiftTo(this.m.t-1,this.r2);if(t.t>this.m.t+1){t.t=this.m.t+1;t.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(t.compareTo(this.r2)<0){t.dAddOffset(1,this.m.t+1)}t.subTo(this.r2,t);while(t.compareTo(this.m)>=0){t.subTo(this.m,t)}};t.prototype.mulTo=function(t,e,i){t.multiplyTo(e,i);this.reduce(i)};t.prototype.sqrTo=function(t,e){t.squareTo(e);this.reduce(e)};return t}();function K(){return new q(null)}function F(t,e){return new q(t,e)}function U(t,e,i,r,n,s){while(--s>=0){var o=e*this[t++]+i[r]+n;n=Math.floor(o/67108864);i[r++]=o&67108863}return n}function k(t,e,i,r,n,s){var o=e&32767;var a=e>>15;while(--s>=0){var h=this[t]&32767;var u=this[t++]>>15;var f=a*h+u*o;h=o*h+((f&32767)<<15)+i[r]+(n&1073741823);n=(h>>>30)+(f>>>15)+a*u+(n>>>30);i[r++]=h&1073741823}return n}function _(t,e,i,r,n,s){var o=e&16383;var a=e>>14;while(--s>=0){var h=this[t]&16383;var u=this[t++]>>14;var f=a*h+u*o;h=o*h+((f&16383)<<14)+i[r]+n;n=(h>>28)+(f>>14)+a*u;i[r++]=h&268435455}return n}q.prototype.am=_;V=28;q.prototype.DB=V;q.prototype.DM=(1<<V)-1;q.prototype.DV=1<<V;var z=52;q.prototype.FV=Math.pow(2,z);q.prototype.F1=z-V;q.prototype.F2=2*V-z;var Z=[];var G;var $;G="0".charCodeAt(0);for($=0;$<=9;++$){Z[G++]=$}G="a".charCodeAt(0);for($=10;$<36;++$){Z[G++]=$}G="A".charCodeAt(0);for($=10;$<36;++$){Z[G++]=$}function Y(t,e){var i=Z[t.charCodeAt(e)];return i==null?-1:i}function J(t){var e=K();e.fromInt(t);return e}function X(t){var e=1;var i;if((i=t>>>16)!=0){t=i;e+=16}if((i=t>>8)!=0){t=i;e+=8}if((i=t>>4)!=0){t=i;e+=4}if((i=t>>2)!=0){t=i;e+=2}if((i=t>>1)!=0){t=i;e+=1}return e}q.ZERO=J(0);q.ONE=J(1);var W=function(){function t(){this.i=0;this.j=0;this.S=[]}t.prototype.init=function(t){var e;var i;var r;for(e=0;e<256;++e){this.S[e]=e}i=0;for(e=0;e<256;++e){i=i+this.S[e]+t[e%t.length]&255;r=this.S[e];this.S[e]=this.S[i];this.S[i]=r}this.i=0;this.j=0};t.prototype.next=function(){var t;this.i=this.i+1&255;this.j=this.j+this.S[this.i]&255;t=this.S[this.i];this.S[this.i]=this.S[this.j];this.S[this.j]=t;return this.S[t+this.S[this.i]&255]};return t}();function Q(){return new W}var tt=256;var et;var it=null;var rt;if(it==null){it=[];rt=0;var nt=void 0;if(i.crypto&&i.crypto.getRandomValues){var st=new Uint32Array(256);i.crypto.getRandomValues(st);for(nt=0;nt<st.length;++nt){it[rt++]=st[nt]&255}}var ot=function(t){this.count=this.count||0;if(this.count>=256||rt>=tt){if(i.removeEventListener){i.removeEventListener("mousemove",ot,false)}else if(i.detachEvent){i.detachEvent("onmousemove",ot)}return}try{var e=t.x+t.y;it[rt++]=e&255;this.count+=1}catch(t){}};if(i.addEventListener){i.addEventListener("mousemove",ot,false)}else if(i.attachEvent){i.attachEvent("onmousemove",ot)}}function at(){if(et==null){et=Q();while(rt<tt){var t=Math.floor(65536*Math.random());it[rt++]=t&255}et.init(it);for(rt=0;rt<it.length;++rt){it[rt]=0}rt=0}return et.next()}var ht=function(){function t(){}t.prototype.nextBytes=function(t){for(var e=0;e<t.length;++e){t[e]=at()}};return t}();function ut(t,e){if(e<t.length+22){console.error("Message too long for RSA");return null}var i=e-t.length-6;var r="";for(var n=0;n<i;n+=2){r+="ff"}var s="0001"+r+"00"+t;return F(s,16)}function ft(t,e){if(e<t.length+11){console.error("Message too long for RSA");return null}var i=[];var r=t.length-1;while(r>=0&&e>0){var n=t.charCodeAt(r--);if(n<128){i[--e]=n}else if(n>127&&n<2048){i[--e]=n&63|128;i[--e]=n>>6|192}else{i[--e]=n&63|128;i[--e]=n>>6&63|128;i[--e]=n>>12|224}}i[--e]=0;var s=new ht;var o=[];while(e>2){o[0]=0;while(o[0]==0){s.nextBytes(o)}i[--e]=o[0]}i[--e]=2;i[--e]=0;return new q(i)}var lt=function(){function t(){this.n=null;this.e=0;this.d=null;this.p=null;this.q=null;this.dmp1=null;this.dmq1=null;this.coeff=null}t.prototype.doPublic=function(t){return t.modPowInt(this.e,this.n)};t.prototype.doPrivate=function(t){if(this.p==null||this.q==null){return t.modPow(this.d,this.n)}var e=t.mod(this.p).modPow(this.dmp1,this.p);var i=t.mod(this.q).modPow(this.dmq1,this.q);while(e.compareTo(i)<0){e=e.add(this.p)}return e.subtract(i).multiply(this.coeff).mod(this.p).multiply(this.q).add(i)};t.prototype.setPublic=function(t,e){if(t!=null&&e!=null&&t.length>0&&e.length>0){this.n=F(t,16);this.e=parseInt(e,16)}else{console.error("Invalid RSA public key")}};t.prototype.encrypt=function(t){var e=ft(t,this.n.bitLength()+7>>3);if(e==null){return null}var i=this.doPublic(e);if(i==null){return null}var r=i.toString(16);if((r.length&1)==0){return r}else{return"0"+r}};t.prototype.setPrivate=function(t,e,i){if(t!=null&&e!=null&&t.length>0&&e.length>0){this.n=F(t,16);this.e=parseInt(e,16);this.d=F(i,16)}else{console.error("Invalid RSA private key")}};t.prototype.setPrivateEx=function(t,e,i,r,n,s,o,a){if(t!=null&&e!=null&&t.length>0&&e.length>0){this.n=F(t,16);this.e=parseInt(e,16);this.d=F(i,16);this.p=F(r,16);this.q=F(n,16);this.dmp1=F(s,16);this.dmq1=F(o,16);this.coeff=F(a,16)}else{console.error("Invalid RSA private key")}};t.prototype.generate=function(t,e){var i=new ht;var r=t>>1;this.e=parseInt(e,16);var n=new q(e,16);for(;;){for(;;){this.p=new q(t-r,1,i);if(this.p.subtract(q.ONE).gcd(n).compareTo(q.ONE)==0&&this.p.isProbablePrime(10)){break}}for(;;){this.q=new q(r,1,i);if(this.q.subtract(q.ONE).gcd(n).compareTo(q.ONE)==0&&this.q.isProbablePrime(10)){break}}if(this.p.compareTo(this.q)<=0){var s=this.p;this.p=this.q;this.q=s}var o=this.p.subtract(q.ONE);var a=this.q.subtract(q.ONE);var h=o.multiply(a);if(h.gcd(n).compareTo(q.ONE)==0){this.n=this.p.multiply(this.q);this.d=n.modInverse(h);this.dmp1=this.d.mod(o);this.dmq1=this.d.mod(a);this.coeff=this.q.modInverse(this.p);break}}};t.prototype.decrypt=function(t){var e=F(t,16);var i=this.doPrivate(e);if(i==null){return null}return ct(i,this.n.bitLength()+7>>3)};t.prototype.generateAsync=function(t,e,n){var s=new ht;var o=t>>1;this.e=parseInt(e,16);var a=new q(e,16);var h=this;var u=function(){var e=function(){if(h.p.compareTo(h.q)<=0){var t=h.p;h.p=h.q;h.q=t}var e=h.p.subtract(q.ONE);var i=h.q.subtract(q.ONE);var r=e.multiply(i);if(r.gcd(a).compareTo(q.ONE)==0){h.n=h.p.multiply(h.q);h.d=a.modInverse(r);h.dmp1=h.d.mod(e);h.dmq1=h.d.mod(i);h.coeff=h.q.modInverse(h.p);setTimeout(function(){n()},0)}else{setTimeout(u,0)}};var i=function(){h.q=K();h.q.fromNumberAsync(o,1,s,function(){h.q.subtract(q.ONE).gcda(a,function(t){if(t.compareTo(q.ONE)==0&&h.q.isProbablePrime(10)){setTimeout(e,0)}else{setTimeout(i,0)}})})};var r=function(){h.p=K();h.p.fromNumberAsync(t-o,1,s,function(){h.p.subtract(q.ONE).gcda(a,function(t){if(t.compareTo(q.ONE)==0&&h.p.isProbablePrime(10)){setTimeout(i,0)}else{setTimeout(r,0)}})})};setTimeout(r,0)};setTimeout(u,0)};t.prototype.sign=function(t,e,i){var r=vt(i);var n=r+e(t).toString();var s=ut(n,this.n.bitLength()/4);if(s==null){return null}var o=this.doPrivate(s);if(o==null){return null}var a=o.toString(16);if((a.length&1)==0){return a}else{return"0"+a}};t.prototype.verify=function(t,e,i){var r=F(e,16);var n=this.doPublic(r);if(n==null){return null}var s=n.toString(16).replace(/^1f+00/,"");var o=gt(s);return o==i(t).toString()};return t}();function ct(t,e){var i=t.toByteArray();var r=0;while(r<i.length&&i[r]==0){++r}if(i.length-r!=e-1||i[r]!=2){return null}++r;while(i[r]!=0){if(++r>=i.length){return null}}var n="";while(++r<i.length){var s=i[r]&255;if(s<128){n+=String.fromCharCode(s)}else if(s>191&&s<224){n+=String.fromCharCode((s&31)<<6|i[r+1]&63);++r}else{n+=String.fromCharCode((s&15)<<12|(i[r+1]&63)<<6|i[r+2]&63);r+=2}}return n}var pt={md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",ripemd160:"3021300906052b2403020105000414"};function vt(t){return pt[t]||""}function gt(t){for(var e in pt){if(pt.hasOwnProperty(e)){var i=pt[e];var r=i.length;if(t.substr(0,r)==i){return t.substr(r)}}}return t}var dt={};dt.lang={extend:function(t,e,i){if(!e||!t){throw new Error("YAHOO.lang.extend failed, please check that "+"all dependencies are included.")}var r=function(){};r.prototype=e.prototype;t.prototype=new r;t.prototype.constructor=t;t.superclass=e.prototype;if(e.prototype.constructor==Object.prototype.constructor){e.prototype.constructor=e}if(i){var n;for(n in i){t.prototype[n]=i[n]}var s=function(){},o=["toString","valueOf"];try{if(/MSIE/.test(a.userAgent)){s=function(t,e){for(n=0;n<o.length;n=n+1){var i=o[n],r=e[i];if(typeof r==="function"&&r!=Object.prototype[i]){t[i]=r}}}}}catch(t){}s(t.prototype,i)}}};var yt={};if(typeof yt.asn1=="undefined"||!yt.asn1)yt.asn1={};yt.asn1.ASN1Util=new function(){this.integerToByteHex=function(t){var e=t.toString(16);if(e.length%2==1)e="0"+e;return e};this.bigIntToMinTwosComplementsHex=function(t){var e=t.toString(16);if(e.substr(0,1)!="-"){if(e.length%2==1){e="0"+e}else{if(!e.match(/^[0-7]/)){e="00"+e}}}else{var i=e.substr(1);var r=i.length;if(r%2==1){r+=1}else{if(!e.match(/^[0-7]/)){r+=2}}var n="";for(var s=0;s<r;s++){n+="f"}var o=new q(n,16);var a=o.xor(t).add(q.ONE);e=a.toString(16).replace(/^-/,"")}return e};this.getPEMStringFromHex=function(t,e){return hextopem(t,e)};this.newObject=function(t){var e=yt,i=e.asn1,r=i.DERBoolean,n=i.DERInteger,s=i.DERBitString,o=i.DEROctetString,a=i.DERNull,h=i.DERObjectIdentifier,u=i.DEREnumerated,f=i.DERUTF8String,l=i.DERNumericString,c=i.DERPrintableString,p=i.DERTeletexString,v=i.DERIA5String,g=i.DERUTCTime,d=i.DERGeneralizedTime,y=i.DERSequence,m=i.DERSet,b=i.DERTaggedObject,T=i.ASN1Util.newObject;var S=Object.keys(t);if(S.length!=1)throw"key of param shall be only one.";var w=S[0];if(":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+w+":")==-1)throw"undefined key: "+w;if(w=="bool")return new r(t[w]);if(w=="int")return new n(t[w]);if(w=="bitstr")return new s(t[w]);if(w=="octstr")return new o(t[w]);if(w=="null")return new a(t[w]);if(w=="oid")return new h(t[w]);if(w=="enum")return new u(t[w]);if(w=="utf8str")return new f(t[w]);if(w=="numstr")return new l(t[w]);if(w=="prnstr")return new c(t[w]);if(w=="telstr")return new p(t[w]);if(w=="ia5str")return new v(t[w]);if(w=="utctime")return new g(t[w]);if(w=="gentime")return new d(t[w]);if(w=="seq"){var E=t[w];var D=[];for(var x=0;x<E.length;x++){var B=T(E[x]);D.push(B)}return new y({array:D})}if(w=="set"){var E=t[w];var D=[];for(var x=0;x<E.length;x++){var B=T(E[x]);D.push(B)}return new m({array:D})}if(w=="tag"){var R=t[w];if(Object.prototype.toString.call(R)==="[object Array]"&&R.length==3){var A=T(R[2]);return new b({tag:R[0],explicit:R[1],obj:A})}else{var O={};if(R.explicit!==undefined)O.explicit=R.explicit;if(R.tag!==undefined)O.tag=R.tag;if(R.obj===undefined)throw"obj shall be specified for 'tag'.";O.obj=T(R.obj);return new b(O)}}};this.jsonToASN1HEX=function(t){var e=this.newObject(t);return e.getEncodedHex()}};yt.asn1.ASN1Util.oidHexToInt=function(t){var e="";var i=parseInt(t.substr(0,2),16);var r=Math.floor(i/40);var n=i%40;var e=r+"."+n;var s="";for(var o=2;o<t.length;o+=2){var a=parseInt(t.substr(o,2),16);var h=("00000000"+a.toString(2)).slice(-8);s=s+h.substr(1,7);if(h.substr(0,1)=="0"){var u=new q(s,2);e=e+"."+u.toString(10);s=""}}return e};yt.asn1.ASN1Util.oidIntToHex=function(t){var h=function(t){var e=t.toString(16);if(e.length==1)e="0"+e;return e};var e=function(t){var e="";var i=new q(t,10);var r=i.toString(2);var n=7-r.length%7;if(n==7)n=0;var s="";for(var o=0;o<n;o++)s+="0";r=s+r;for(var o=0;o<r.length-1;o+=7){var a=r.substr(o,7);if(o!=r.length-7)a="1"+a;e+=h(parseInt(a,2))}return e};if(!t.match(/^[0-9.]+$/)){throw"malformed oid string: "+t}var i="";var r=t.split(".");var n=parseInt(r[0])*40+parseInt(r[1]);i+=h(n);r.splice(0,2);for(var s=0;s<r.length;s++){i+=e(r[s])}return i};yt.asn1.ASN1Object=function(){var n="";this.getLengthHexFromValue=function(){if(typeof this.hV=="undefined"||this.hV==null){throw"this.hV is null or undefined."}if(this.hV.length%2==1){throw"value hex must be even length: n="+n.length+",v="+this.hV}var t=this.hV.length/2;var e=t.toString(16);if(e.length%2==1){e="0"+e}if(t<128){return e}else{var i=e.length/2;if(i>15){throw"ASN.1 length too long to represent by 8x: n = "+t.toString(16)}var r=128+i;return r.toString(16)+e}};this.getEncodedHex=function(){if(this.hTLV==null||this.isModified){this.hV=this.getFreshValueHex();this.hL=this.getLengthHexFromValue();this.hTLV=this.hT+this.hL+this.hV;this.isModified=false}return this.hTLV};this.getValueHex=function(){this.getEncodedHex();return this.hV};this.getFreshValueHex=function(){return""}};yt.asn1.DERAbstractString=function(t){yt.asn1.DERAbstractString.superclass.constructor.call(this);this.getString=function(){return this.s};this.setString=function(t){this.hTLV=null;this.isModified=true;this.s=t;this.hV=stohex(this.s)};this.setStringHex=function(t){this.hTLV=null;this.isModified=true;this.s=null;this.hV=t};this.getFreshValueHex=function(){return this.hV};if(typeof t!="undefined"){if(typeof t=="string"){this.setString(t)}else if(typeof t["str"]!="undefined"){this.setString(t["str"])}else if(typeof t["hex"]!="undefined"){this.setStringHex(t["hex"])}}};dt.lang.extend(yt.asn1.DERAbstractString,yt.asn1.ASN1Object);yt.asn1.DERAbstractTime=function(t){yt.asn1.DERAbstractTime.superclass.constructor.call(this);this.localDateToUTC=function(t){utc=t.getTime()+t.getTimezoneOffset()*6e4;var e=new Date(utc);return e};this.formatDate=function(t,e,i){var r=this.zeroPadding;var n=this.localDateToUTC(t);var s=String(n.getFullYear());if(e=="utc")s=s.substr(2,2);var o=r(String(n.getMonth()+1),2);var a=r(String(n.getDate()),2);var h=r(String(n.getHours()),2);var u=r(String(n.getMinutes()),2);var f=r(String(n.getSeconds()),2);var l=s+o+a+h+u+f;if(i===true){var c=n.getMilliseconds();if(c!=0){var p=r(String(c),3);p=p.replace(/[0]+$/,"");l=l+"."+p}}return l+"Z"};this.zeroPadding=function(t,e){if(t.length>=e)return t;return new Array(e-t.length+1).join("0")+t};this.getString=function(){return this.s};this.setString=function(t){this.hTLV=null;this.isModified=true;this.s=t;this.hV=stohex(t)};this.setByDateValue=function(t,e,i,r,n,s){var o=new Date(Date.UTC(t,e-1,i,r,n,s,0));this.setByDate(o)};this.getFreshValueHex=function(){return this.hV}};dt.lang.extend(yt.asn1.DERAbstractTime,yt.asn1.ASN1Object);yt.asn1.DERAbstractStructured=function(t){yt.asn1.DERAbstractString.superclass.constructor.call(this);this.setByASN1ObjectArray=function(t){this.hTLV=null;this.isModified=true;this.asn1Array=t};this.appendASN1Object=function(t){this.hTLV=null;this.isModified=true;this.asn1Array.push(t)};this.asn1Array=new Array;if(typeof t!="undefined"){if(typeof t["array"]!="undefined"){this.asn1Array=t["array"]}}};dt.lang.extend(yt.asn1.DERAbstractStructured,yt.asn1.ASN1Object);yt.asn1.DERBoolean=function(){yt.asn1.DERBoolean.superclass.constructor.call(this);this.hT="01";this.hTLV="0101ff"};dt.lang.extend(yt.asn1.DERBoolean,yt.asn1.ASN1Object);yt.asn1.DERInteger=function(t){yt.asn1.DERInteger.superclass.constructor.call(this);this.hT="02";this.setByBigInteger=function(t){this.hTLV=null;this.isModified=true;this.hV=yt.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)};this.setByInteger=function(t){var e=new q(String(t),10);this.setByBigInteger(e)};this.setValueHex=function(t){this.hV=t};this.getFreshValueHex=function(){return this.hV};if(typeof t!="undefined"){if(typeof t["bigint"]!="undefined"){this.setByBigInteger(t["bigint"])}else if(typeof t["int"]!="undefined"){this.setByInteger(t["int"])}else if(typeof t=="number"){this.setByInteger(t)}else if(typeof t["hex"]!="undefined"){this.setValueHex(t["hex"])}}};dt.lang.extend(yt.asn1.DERInteger,yt.asn1.ASN1Object);yt.asn1.DERBitString=function(t){if(t!==undefined&&typeof t.obj!=="undefined"){var e=yt.asn1.ASN1Util.newObject(t.obj);t.hex="00"+e.getEncodedHex()}yt.asn1.DERBitString.superclass.constructor.call(this);this.hT="03";this.setHexValueIncludingUnusedBits=function(t){this.hTLV=null;this.isModified=true;this.hV=t};this.setUnusedBitsAndHexValue=function(t,e){if(t<0||7<t){throw"unused bits shall be from 0 to 7: u = "+t}var i="0"+t;this.hTLV=null;this.isModified=true;this.hV=i+e};this.setByBinaryString=function(t){t=t.replace(/0+$/,"");var e=8-t.length%8;if(e==8)e=0;for(var i=0;i<=e;i++){t+="0"}var r="";for(var i=0;i<t.length-1;i+=8){var n=t.substr(i,8);var s=parseInt(n,2).toString(16);if(s.length==1)s="0"+s;r+=s}this.hTLV=null;this.isModified=true;this.hV="0"+e+r};this.setByBooleanArray=function(t){var e="";for(var i=0;i<t.length;i++){if(t[i]==true){e+="1"}else{e+="0"}}this.setByBinaryString(e)};this.newFalseArray=function(t){var e=new Array(t);for(var i=0;i<t;i++){e[i]=false}return e};this.getFreshValueHex=function(){return this.hV};if(typeof t!="undefined"){if(typeof t=="string"&&t.toLowerCase().match(/^[0-9a-f]+$/)){this.setHexValueIncludingUnusedBits(t)}else if(typeof t["hex"]!="undefined"){this.setHexValueIncludingUnusedBits(t["hex"])}else if(typeof t["bin"]!="undefined"){this.setByBinaryString(t["bin"])}else if(typeof t["array"]!="undefined"){this.setByBooleanArray(t["array"])}}};dt.lang.extend(yt.asn1.DERBitString,yt.asn1.ASN1Object);yt.asn1.DEROctetString=function(t){if(t!==undefined&&typeof t.obj!=="undefined"){var e=yt.asn1.ASN1Util.newObject(t.obj);t.hex=e.getEncodedHex()}yt.asn1.DEROctetString.superclass.constructor.call(this,t);this.hT="04"};dt.lang.extend(yt.asn1.DEROctetString,yt.asn1.DERAbstractString);yt.asn1.DERNull=function(){yt.asn1.DERNull.superclass.constructor.call(this);this.hT="05";this.hTLV="0500"};dt.lang.extend(yt.asn1.DERNull,yt.asn1.ASN1Object);yt.asn1.DERObjectIdentifier=function(t){var h=function(t){var e=t.toString(16);if(e.length==1)e="0"+e;return e};var s=function(t){var e="";var i=new q(t,10);var r=i.toString(2);var n=7-r.length%7;if(n==7)n=0;var s="";for(var o=0;o<n;o++)s+="0";r=s+r;for(var o=0;o<r.length-1;o+=7){var a=r.substr(o,7);if(o!=r.length-7)a="1"+a;e+=h(parseInt(a,2))}return e};yt.asn1.DERObjectIdentifier.superclass.constructor.call(this);this.hT="06";this.setValueHex=function(t){this.hTLV=null;this.isModified=true;this.s=null;this.hV=t};this.setValueOidString=function(t){if(!t.match(/^[0-9.]+$/)){throw"malformed oid string: "+t}var e="";var i=t.split(".");var r=parseInt(i[0])*40+parseInt(i[1]);e+=h(r);i.splice(0,2);for(var n=0;n<i.length;n++){e+=s(i[n])}this.hTLV=null;this.isModified=true;this.s=null;this.hV=e};this.setValueName=function(t){var e=yt.asn1.x509.OID.name2oid(t);if(e!==""){this.setValueOidString(e)}else{throw"DERObjectIdentifier oidName undefined: "+t}};this.getFreshValueHex=function(){return this.hV};if(t!==undefined){if(typeof t==="string"){if(t.match(/^[0-2].[0-9.]+$/)){this.setValueOidString(t)}else{this.setValueName(t)}}else if(t.oid!==undefined){this.setValueOidString(t.oid)}else if(t.hex!==undefined){this.setValueHex(t.hex)}else if(t.name!==undefined){this.setValueName(t.name)}}};dt.lang.extend(yt.asn1.DERObjectIdentifier,yt.asn1.ASN1Object);yt.asn1.DEREnumerated=function(t){yt.asn1.DEREnumerated.superclass.constructor.call(this);this.hT="0a";this.setByBigInteger=function(t){this.hTLV=null;this.isModified=true;this.hV=yt.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)};this.setByInteger=function(t){var e=new q(String(t),10);this.setByBigInteger(e)};this.setValueHex=function(t){this.hV=t};this.getFreshValueHex=function(){return this.hV};if(typeof t!="undefined"){if(typeof t["int"]!="undefined"){this.setByInteger(t["int"])}else if(typeof t=="number"){this.setByInteger(t)}else if(typeof t["hex"]!="undefined"){this.setValueHex(t["hex"])}}};dt.lang.extend(yt.asn1.DEREnumerated,yt.asn1.ASN1Object);yt.asn1.DERUTF8String=function(t){yt.asn1.DERUTF8String.superclass.constructor.call(this,t);this.hT="0c"};dt.lang.extend(yt.asn1.DERUTF8String,yt.asn1.DERAbstractString);yt.asn1.DERNumericString=function(t){yt.asn1.DERNumericString.superclass.constructor.call(this,t);this.hT="12"};dt.lang.extend(yt.asn1.DERNumericString,yt.asn1.DERAbstractString);yt.asn1.DERPrintableString=function(t){yt.asn1.DERPrintableString.superclass.constructor.call(this,t);this.hT="13"};dt.lang.extend(yt.asn1.DERPrintableString,yt.asn1.DERAbstractString);yt.asn1.DERTeletexString=function(t){yt.asn1.DERTeletexString.superclass.constructor.call(this,t);this.hT="14"};dt.lang.extend(yt.asn1.DERTeletexString,yt.asn1.DERAbstractString);yt.asn1.DERIA5String=function(t){yt.asn1.DERIA5String.superclass.constructor.call(this,t);this.hT="16"};dt.lang.extend(yt.asn1.DERIA5String,yt.asn1.DERAbstractString);yt.asn1.DERUTCTime=function(t){yt.asn1.DERUTCTime.superclass.constructor.call(this,t);this.hT="17";this.setByDate=function(t){this.hTLV=null;this.isModified=true;this.date=t;this.s=this.formatDate(this.date,"utc");this.hV=stohex(this.s)};this.getFreshValueHex=function(){if(typeof this.date=="undefined"&&typeof this.s=="undefined"){this.date=new Date;this.s=this.formatDate(this.date,"utc");this.hV=stohex(this.s)}return this.hV};if(t!==undefined){if(t.str!==undefined){this.setString(t.str)}else if(typeof t=="string"&&t.match(/^[0-9]{12}Z$/)){this.setString(t)}else if(t.hex!==undefined){this.setStringHex(t.hex)}else if(t.date!==undefined){this.setByDate(t.date)}}};dt.lang.extend(yt.asn1.DERUTCTime,yt.asn1.DERAbstractTime);yt.asn1.DERGeneralizedTime=function(t){yt.asn1.DERGeneralizedTime.superclass.constructor.call(this,t);this.hT="18";this.withMillis=false;this.setByDate=function(t){this.hTLV=null;this.isModified=true;this.date=t;this.s=this.formatDate(this.date,"gen",this.withMillis);this.hV=stohex(this.s)};this.getFreshValueHex=function(){if(this.date===undefined&&this.s===undefined){this.date=new Date;this.s=this.formatDate(this.date,"gen",this.withMillis);this.hV=stohex(this.s)}return this.hV};if(t!==undefined){if(t.str!==undefined){this.setString(t.str)}else if(typeof t=="string"&&t.match(/^[0-9]{14}Z$/)){this.setString(t)}else if(t.hex!==undefined){this.setStringHex(t.hex)}else if(t.date!==undefined){this.setByDate(t.date)}if(t.millis===true){this.withMillis=true}}};dt.lang.extend(yt.asn1.DERGeneralizedTime,yt.asn1.DERAbstractTime);yt.asn1.DERSequence=function(t){yt.asn1.DERSequence.superclass.constructor.call(this,t);this.hT="30";this.getFreshValueHex=function(){var t="";for(var e=0;e<this.asn1Array.length;e++){var i=this.asn1Array[e];t+=i.getEncodedHex()}this.hV=t;return this.hV}};dt.lang.extend(yt.asn1.DERSequence,yt.asn1.DERAbstractStructured);yt.asn1.DERSet=function(t){yt.asn1.DERSet.superclass.constructor.call(this,t);this.hT="31";this.sortFlag=true;this.getFreshValueHex=function(){var t=new Array;for(var e=0;e<this.asn1Array.length;e++){var i=this.asn1Array[e];t.push(i.getEncodedHex())}if(this.sortFlag==true)t.sort();this.hV=t.join("");return this.hV};if(typeof t!="undefined"){if(typeof t.sortflag!="undefined"&&t.sortflag==false)this.sortFlag=false}};dt.lang.extend(yt.asn1.DERSet,yt.asn1.DERAbstractStructured);yt.asn1.DERTaggedObject=function(t){yt.asn1.DERTaggedObject.superclass.constructor.call(this);this.hT="a0";this.hV="";this.isExplicit=true;this.asn1Object=null;this.setASN1Object=function(t,e,i){this.hT=e;this.isExplicit=t;this.asn1Object=i;if(this.isExplicit){this.hV=this.asn1Object.getEncodedHex();this.hTLV=null;this.isModified=true}else{this.hV=null;this.hTLV=i.getEncodedHex();this.hTLV=this.hTLV.replace(/^../,e);this.isModified=false}};this.getFreshValueHex=function(){return this.hV};if(typeof t!="undefined"){if(typeof t["tag"]!="undefined"){this.hT=t["tag"]}if(typeof t["explicit"]!="undefined"){this.isExplicit=t["explicit"]}if(typeof t["obj"]!="undefined"){this.asn1Object=t["obj"];this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)}}};dt.lang.extend(yt.asn1.DERTaggedObject,yt.asn1.ASN1Object);var mt=function(i){d(r,i);function r(t){var e=i.call(this)||this;if(t){if(typeof t==="string"){e.parseKey(t)}else if(r.hasPrivateKeyProperty(t)||r.hasPublicKeyProperty(t)){e.parsePropertiesFrom(t)}}return e}r.prototype.parseKey=function(t){try{var e=0;var i=0;var r=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/;var n=r.test(t)?m.decode(t):T.unarmor(t);var s=A.decode(n);if(s.sub.length===3){s=s.sub[2].sub[0]}if(s.sub.length===9){e=s.sub[1].getHexStringValue();this.n=F(e,16);i=s.sub[2].getHexStringValue();this.e=parseInt(i,16);var o=s.sub[3].getHexStringValue();this.d=F(o,16);var a=s.sub[4].getHexStringValue();this.p=F(a,16);var h=s.sub[5].getHexStringValue();this.q=F(h,16);var u=s.sub[6].getHexStringValue();this.dmp1=F(u,16);var f=s.sub[7].getHexStringValue();this.dmq1=F(f,16);var l=s.sub[8].getHexStringValue();this.coeff=F(l,16)}else if(s.sub.length===2){var c=s.sub[1];var p=c.sub[0];e=p.sub[0].getHexStringValue();this.n=F(e,16);i=p.sub[1].getHexStringValue();this.e=parseInt(i,16)}else{return false}return true}catch(t){return false}};r.prototype.getPrivateBaseKey=function(){var t={array:[new yt.asn1.DERInteger({int:0}),new yt.asn1.DERInteger({bigint:this.n}),new yt.asn1.DERInteger({int:this.e}),new yt.asn1.DERInteger({bigint:this.d}),new yt.asn1.DERInteger({bigint:this.p}),new yt.asn1.DERInteger({bigint:this.q}),new yt.asn1.DERInteger({bigint:this.dmp1}),new yt.asn1.DERInteger({bigint:this.dmq1}),new yt.asn1.DERInteger({bigint:this.coeff})]};var e=new yt.asn1.DERSequence(t);return e.getEncodedHex()};r.prototype.getPrivateBaseKeyB64=function(){return g(this.getPrivateBaseKey())};r.prototype.getPublicBaseKey=function(){var t=new yt.asn1.DERSequence({array:[new yt.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new yt.asn1.DERNull]});var e=new yt.asn1.DERSequence({array:[new yt.asn1.DERInteger({bigint:this.n}),new yt.asn1.DERInteger({int:this.e})]});var i=new yt.asn1.DERBitString({hex:"00"+e.getEncodedHex()});var r=new yt.asn1.DERSequence({array:[t,i]});return r.getEncodedHex()};r.prototype.getPublicBaseKeyB64=function(){return g(this.getPublicBaseKey())};r.wordwrap=function(t,e){e=e||64;if(!t){return t}var i="(.{1,"+e+"})( +|$\n?)|(.{1,"+e+"})";return t.match(RegExp(i,"g")).join("\n")};r.prototype.getPrivateKey=function(){var t="-----BEGIN RSA PRIVATE KEY-----\n";t+=r.wordwrap(this.getPrivateBaseKeyB64())+"\n";t+="-----END RSA PRIVATE KEY-----";return t};r.prototype.getPublicKey=function(){var t="-----BEGIN PUBLIC KEY-----\n";t+=r.wordwrap(this.getPublicBaseKeyB64())+"\n";t+="-----END PUBLIC KEY-----";return t};r.hasPublicKeyProperty=function(t){t=t||{};return t.hasOwnProperty("n")&&t.hasOwnProperty("e")};r.hasPrivateKeyProperty=function(t){t=t||{};return t.hasOwnProperty("n")&&t.hasOwnProperty("e")&&t.hasOwnProperty("d")&&t.hasOwnProperty("p")&&t.hasOwnProperty("q")&&t.hasOwnProperty("dmp1")&&t.hasOwnProperty("dmq1")&&t.hasOwnProperty("coeff")};r.prototype.parsePropertiesFrom=function(t){this.n=t.n;this.e=t.e;if(t.hasOwnProperty("d")){this.d=t.d;this.p=t.p;this.q=t.q;this.dmp1=t.dmp1;this.dmq1=t.dmq1;this.coeff=t.coeff}};return r}(lt);var bt=function(){function t(t){t=t||{};this.default_key_size=parseInt(t.default_key_size,10)||1024;this.default_public_exponent=t.default_public_exponent||"010001";this.log=t.log||false;this.key=null}t.prototype.setKey=function(t){if(this.log&&this.key){console.warn("A key was already set, overriding existing.")}this.key=new mt(t)};t.prototype.setPrivateKey=function(t){this.setKey(t)};t.prototype.setPublicKey=function(t){this.setKey(t)};t.prototype.decrypt=function(t){try{return this.getKey().decrypt(p(t))}catch(t){return false}};t.prototype.encrypt=function(t){try{return g(this.getKey().encrypt(t))}catch(t){return false}};t.prototype.encryptLong2=function(t){var e=this.getKey();try{var i="";var r="";var n=new Array;n.push(0);var s=0;var o,a;o=t.length;var h=0;for(var u=0;u<o;u++){a=t.charCodeAt(u);if(a>=65536&&a<=1114111){s+=4}else if(a>=2048&&a<=65535){s+=3}else if(a>=128&&a<=2047){s+=2}else{s+=1}if(s%117>=114||s%117==0){if(s-h>=114){n.push(u);h=s}}}if(n.length>1){for(var u=0;u<n.length-1;u++){var f;if(u==0){f=t.substring(0,n[u+1]+1)}else{f=t.substring(n[u]+1,n[u+1]+1)}var l=e.encrypt(f);r+=l}if(n[n.length-1]!=t.length-1){var c=t.substring(n[n.length-1]+1);r+=e.encrypt(c)}return r}var p=e.encrypt(t);var v=g(p);return p}catch(t){return false}};t.prototype.sign=function(t,e,i){try{return g(this.getKey().sign(t,e,i))}catch(t){return false}};t.prototype.verify=function(t,e,i){try{return this.getKey().verify(t,p(e),i)}catch(t){return false}};t.prototype.getKey=function(t){if(!this.key){this.key=new mt;if(t&&{}.toString.call(t)==="[object Function]"){this.key.generateAsync(this.default_key_size,this.default_public_exponent,t);return}this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key};t.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()};t.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()};t.prototype.getPublicKey=function(){return this.getKey().getPublicKey()};t.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()};t.version="3.0.0-rc.1";return t}();t.JSEncrypt=bt;t.default=bt;Object.defineProperty(t,"__esModule",{value:true})});